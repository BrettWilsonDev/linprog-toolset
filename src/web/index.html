<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Linear Programming Toolset</title>
  <style>
    /* Generic CSS for web tools with pitch black theme and amber accents */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, Helvetica, sans-serif;
    }

    body {
      display: flex;
      background-color: #000000;
      /* Pitch black background */
      color: #FFFFFF;
      /* White text */
      height: 99vh;
      /* height: 100vh; */
      overflow: hidden;
      /* padding-top: 60px; */
      /* Dead space at top of page */
    }

    /* Sidebar */
    aside {
      width: 290px;
      background: #1A1A1A;
      /* Dark gray */
      color: #FFFFFF;
      padding: 1rem;
      transition: transform 0.3s ease;
      position: fixed;
      /* top: 60px; */
      /* Align below body padding */
      /* height: calc(100% - 60px); */
      height: 100vh;
      /* Adjust height for top padding */
      overflow-y: auto;
      /* z-index: 1000; */
    }

    aside.hidden {
      transform: translateX(-100%);
    }

    aside h2 {
      font-size: 1.2rem;
      color: #CC3300;
      /* Soft amber */
      margin-bottom: 0.5rem;
    }

    aside button {
      display: block;
      width: 100%;
      margin: 0.25rem 0;
      padding: 0.5rem;
      background: #333333;
      color: #FFFFFF;
      border: none;
      cursor: pointer;
      border-radius: 4px;
      text-align: left;
      font-size: 0.9rem;
      font-weight: bold;
      transition: background 0.2s ease;
      z-index: 9999;
      position: relative;
    }

    aside button:hover {
      background: #CC3300;
      /* Amber on hover */
      color: #000000;
    }

    /* Main content */
    main {
      flex: 1;
      padding: 1rem;
      margin-left: 290px;
      overflow-y: auto;
      transition: margin-left 0.3s ease;
    }

    main.full-width {
      margin-left: 0;
    }

    /* Toggle button (hamburger) */
    .toggle-sidebar {
      position: fixed;
      top: 20px;
      /* Inside dead space */
      left: 20px;
      background: #CC3300;
      /* Soft amber */
      color: #000000;
      border: none;
      padding: 6px 10px;
      cursor: pointer;
      border-radius: 4px;
      font-size: 1rem;
      z-index: 1200;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      z-index: 1;
    }

    .toggle-sidebar:hover {
      background: #FF9800;
      /* Darker amber on hover */
    }

    /* Hamburger/close icon */
    /* .toggle-sidebar::before {
      content: "☰";
    } */

    /* .toggle-sidebar:hover::before {
      content: "✕";
    } */

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }

    #form textarea:focus,
    #form input:focus,
    #form select:focus {
      border-color: #CC3300;
      /* Amber border on focus */
      outline: none;
    }

    /* Results area */
    #results {
      background: #1A1A1A;
      border: 1px solid #333333;
      padding: 10px;
      border-radius: 4px;
      color: #FFFFFF;
      /* // text-align: center; Center text in output/results */
    }

    /* Headings */
    h1 {
      color: #CC3300;
      /* Amber title */
      margin-bottom: 1rem;
    }

    /* Responsive adjustments */
    @media (max-width: 600px) {
      aside {
        /* width: 200px; */
        /* top: 50px; */
        /* height: calc(100% - 50px); */
        /* height: 100%; */
      }

      body {
        /* padding-top: 50px; */
      }

      main {
        /* margin-left: 200px; */
      }

      main.full-width {
        /* margin-left: 0; */
      }

      /* .toggle-sidebar {
        top: 8px;
        left: 8px;
        width: 32px;
        height: 32px;
        font-size: 0.9rem;
      } */


    }
  </style>
</head>

<body>
  <button class="toggle-sidebar" onclick="toggleSidebar()">✕</button>
  <aside id="sidebar">
    <h2 style="margin-left: 60px; margin-top: 10px;">Algorithms</h2>
    <button style="margin-top: 30px;" onclick="loadUI('adding_activities_and_constraints')">Adding Activities And
      Constraints</button>
    <button onclick="loadUI('branch_and_bound')">Branch And Bound Simplex</button>
    <button onclick="loadUI('knapsack')">Branch And Bound Knapsack</button>
    <button onclick="loadUI('cheapest_insertion_tsp')">Cheapest Insertion TSP</button>
    <button onclick="loadUI('nearest_neighbor_tsp')">Nearest Neighbor TSP</button>
    <button onclick="loadUI('cutting_plane')">Cutting Plane</button>
    <button onclick="loadUI('dea')">Data Envelopment Analysis</button>
    <button onclick="loadUI('steepest_descent')">Steepest Descent</button>
    <button onclick="loadUI('dual_simplex')">Dual Simplex</button>
    <button onclick="loadUI('duality')">Linear Programming Duality</button>
    <button onclick="loadUI('goal_penalties_simplex')">Goal Penalties Simplex</button>
    <button onclick="loadUI('goal_preemptive_simplex')">Goal Preemptive Simplex</button>
    <button onclick="loadUI('goldenratio_search')">Golden Ratio Search</button>
    <button onclick="loadUI('graphical_solver')">Graphical Solver</button>
    <button onclick="loadUI('hungarian_algorithm')">Hungarian Algorithm</button>
    <button onclick="loadUI('machine_scheduling')">Machine Scheduling</button>
    <button onclick="loadUI('math_preliminaries')">Math Preliminaries</button>
    <button onclick="loadUI('sensitivity_analysis')">Sensitivity Analysis</button>
    <button style="margin-bottom: 20vh;" onclick="loadUI('two_phase_simplex')">Two Phase Simplex</button>
  </aside>

  <main id="main-content">
    <h1 style="margin-left: 60px;" id="title">← Select an Algorithm</h1>
    <div id="form"></div>
    <div style="margin-bottom: 10vh;" id="results">
      <p><b>Adding Activities And Constraints:</b> lets you add variables and constraints to your LP model.</p>
      <br>
      <p><b>Branch And Bound Simplex:</b> solves integer programs by branching on fractional variables and solving LP
        relaxations.</p>
      <br>
      <p><b>Branch And Bound Knapsack:</b> exact method for 0/1 knapsack using upper/lower bounds to prune branches.</p>
      <br>
      <p><b>Cheapest Insertion TSP:</b> heuristic for TSP that adds the cheapest city insertion each step.</p>
      <br>
      <p><b>Nearest Neighbor TSP:</b> simple TSP heuristic that always picks the nearest unvisited city next.</p>
      <br>
      <p><b>Cutting Plane:</b> adds linear cuts to LP relaxations to force integer solutions.</p>
      <br>
      <p><b>Data Envelopment Analysis:</b> measures efficiency of decision-making units using inputs and outputs.</p>
      <br>
      <p><b>Steepest Descent:</b> moves opposite the gradient to minimize a function.</p>
      <br>
      <p><b>Dual Simplex:</b> a version of Simplex that fixes infeasible constraints while keeping dual feasibility.</p>
      <br>
      <p><b>Linear Programming Duality:</b> every LP has a dual that provides bounds and shadow prices.</p>
      <br>
      <p><b>Goal Penalties Simplex:</b> goal programming with weighted penalties for goal violations.</p>
      <br>
      <p><b>Goal Preemptive Simplex:</b> lexicographic goal programming where higher-priority goals dominate.</p>
      <br>
      <p><b>Golden Ratio Search:</b> 1D optimization without derivatives using golden section intervals.</p>
      <br>
      <p><b>Graphical Solver:</b> solves 2-variable LPs visually by plotting constraints and feasible region.</p>
      <br>
      <p><b>Hungarian Algorithm:</b> solves the assignment problem to minimize total cost.</p>
      <br>
      <p><b>Machine Scheduling:</b> allocates jobs to machines to minimize total time or tardiness.</p>
      <br>
      <p><b>Math Preliminaries:</b> basic math background for optimization topics.</p>
      <br>
      <p><b>Sensitivity Analysis:</b> studies how optimal LP solutions change when parameters vary.</p>
      <br>
      <p><b>Two Phase Simplex:</b> Phase I finds feasibility, Phase II optimizes the real objective.</p>

    </div>
  </main>

  <script type="module">
    import ModuleFactory from "./wasm/linprog-toolset.js";
    import * as dual_simplex from "./ui/dual_simplex.js";
    import * as two_phase_simplex from "./ui/two_phase_simplex.js";
    import * as graphical_solver from "./ui/graphical_solver.js";
    import * as goal_penalties_simplex from "./ui/goal_penalties_simplex.js";
    import * as goal_preemptive_simplex from "./ui/goal_preemptive_simplex.js";
    import * as math_preliminaries from "./ui/math_preliminaries.js";
    import * as sensitivity_analysis from "./ui/sensitivity_analysis.js";
    import * as duality from "./ui/duality.js";
    import * as dea from "./ui/dea.js";
    import * as adding_activities_and_constraints from "./ui/adding_activities_and_constraints.js";
    import * as knapsack from "./ui/knapsack.js";
    import * as branch_and_bound from "./ui/branch_and_bound.js";
    import * as cutting_plane from "./ui/cutting_plane.js";
    import * as cheapest_insertion_tsp from "./ui/cheapest_insertion_tsp.js";
    import * as nearest_neighbor_tsp from "./ui/nearest_neighbor_tsp.js";
    import * as hungarian_algorithm from "./ui/hungarian_algorithm.js";
    import * as machine_scheduling from "./ui/machine_scheduling.js";
    import * as goldenratio_search from "./ui/goldenratio_search.js";
    import * as steepest_descent from "./ui/steepest_descent.js";

    let Module = null;

    async function initWasm() {
      if (!Module) {
        Module = await ModuleFactory();
        console.log("WASM module initialized");
      }
      return Module;
    }

    window.onload = async function () {
      await initWasm();
    };

    const uiModules = {
      dual_simplex,
      two_phase_simplex,
      graphical_solver,
      goal_penalties_simplex,
      goal_preemptive_simplex,
      math_preliminaries,
      sensitivity_analysis,
      duality,
      dea,
      adding_activities_and_constraints,
      knapsack,
      branch_and_bound,
      cutting_plane,
      cheapest_insertion_tsp,
      nearest_neighbor_tsp,
      hungarian_algorithm,
      machine_scheduling,
      goldenratio_search,
      steepest_descent,
    };

    window.loadUI = async (algo) => {
      const module = uiModules[algo];
      if (!module) {
        document.getElementById("title").innerText = "Unknown algorithm";
        return;
      }

      document.getElementById("title").innerText = "";
      document.getElementById("form").innerHTML = "";
      document.getElementById("results").innerHTML = "";

      const wasm = await initWasm();
      module.render(document.getElementById("form"), document.getElementById("results"), wasm);
    };

    window.verbose = function () {
      Module.toggleVerbose();
    };

    let toggleBool = false;
    window.toggleSidebar = function () {
      const sidebar = document.getElementById("sidebar");
      const mainContent = document.getElementById("main-content");
      sidebar.classList.toggle("hidden");
      mainContent.classList.toggle("full-width");
      const toggleButton = document.querySelector(".toggle-sidebar");
      // toggleButton.innerHTML = "☰";

      toggleBool = !toggleBool;

      if (toggleBool) {
        toggleButton.innerHTML = "✕";
        toggleButton.innerHTML = "☰";
      }
      else {
        toggleButton.innerHTML = "☰";
        toggleButton.innerHTML = "✕";
      }

    };
  </script>

</body>

</html>